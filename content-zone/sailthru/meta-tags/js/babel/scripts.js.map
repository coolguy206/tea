{"version":3,"sources":["../scripts.js"],"names":["$","document","ready","url","window","location","href","color","indexOf","split","toLowerCase","console","log","mpd","text","json","JSON","parse","gender","attr","category","thePrice","priceTag","imgURL","sku","sig","price","inventory","Number","tags","api_key","secret","format","undefined","replace","each","parent_data","i","val","thisColor","large_image_url","theSku","store_price","substring","slice","theJSON","md5","data","FormData","append","xhr","XMLHttpRequest","withCredentials","addEventListener","readyState","responseText","open","send","Sailthru","track","onSuccess","onError"],"mappings":"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","sourcesContent":["$(document).ready(function() {\r\n  var url = window.location.href;\r\n  var color;\r\n  if (url.indexOf('?') !== -1) {\r\n    color = url.split('?')[1];\r\n    color = color.split('#')[1];\r\n    color = color.toLowerCase();\r\n  } else {\r\n    color = url.split('#')[1];\r\n    color = color.toLowerCase();\r\n  }\r\n  console.log(color);\r\n\r\n\r\n  var mpd = $('#the-mpd').text();\r\n  var json = JSON.parse(mpd);\r\n  var gender = $('#the-mpd').attr('data-department').toLowerCase();\r\n  var category = $('#the-mpd').attr('data-category').toLowerCase();\r\n  var thePrice;\r\n  var priceTag;\r\n  var imgURL;\r\n  var sku;\r\n  var sig;\r\n  var price;\r\n  var inventory = Number($('meta[name=\"inventory\"]').attr('content'));\r\n  var tags = `tea, tea-collection, kids-clothes, children-clothes, kids-clothing, kids-outfits, ${gender}, ${category}`;\r\n  // console.log(`inventory: ${inventory}`);\r\n\r\n  var api_key = `8379ab7deccf4e4aa16a01990e0f4fa2`;\r\n  var secret = `a05b94dd5722b409a097f77b14795d05`;\r\n  var format = `json`;\r\n\r\n\r\n  if (color !== undefined) {\r\n\r\n    color = color.replace(/%20/g, \" \");\r\n\r\n    $.each(json.parent_data, function(i, val) {\r\n      var thisColor = val.color;\r\n      thisColor = thisColor.toLowerCase();\r\n\r\n      if (color == thisColor) {\r\n        imgURL = val.large_image_url;\r\n\r\n        var theSku = val.sku;\r\n        theSku = theSku.split('-');\r\n        theSku = theSku[0] + '-' + theSku[1];\r\n        sku = theSku;\r\n        // console.log(theSku);\r\n\r\n        thePrice = val.store_price;\r\n        thePrice = Number(thePrice.substring(1));\r\n\r\n        price = val.store_price;\r\n        price = Number(price.slice(1)) * 100;\r\n\r\n        //console.log(price);\r\n      }\r\n    });\r\n\r\n\r\n    console.log(thePrice);\r\n    if (thePrice <= 25) {\r\n      priceTag = `price-0-25`;\r\n    } else if (thePrice > 25 && thePrice <= 50) {\r\n      priceTag = `price-25-50`;\r\n    } else if (thePrice > 50 && thePrice <= 75) {\r\n      priceTag = `price-50-75`;\r\n    } else if (thePrice > 75 && thePrice <= 100) {\r\n      priceTag = `price-75-100`;\r\n    } else if (thePrice > 100) {\r\n      priceTag = `price-100+`\r\n    }\r\n    console.log(priceTag);\r\n\r\n    tags = `${tags}, ${priceTag}`\r\n\r\n    var theJSON = `{\"id\": \"${url}\", \"tags\": \"${tags}\", \"inventory\": ${inventory}, \"price\": ${price}, \"images\":{\"full\": {\"url\": \"${imgURL}\"}, \"thumb\": {\"url\": \"${imgURL}\"}}}`;\r\n    sig = md5(secret + api_key + format + theJSON);\r\n\r\n\r\n    console.log(`\r\n    sig: ${sig}\r\n    \"json\": ${theJSON}\r\n    `);\r\n\r\n\r\n    // var settings = {\r\n    //   \"url\": \"https://api.sailthru.com/content\",\r\n    //   \"method\": \"POST\",\r\n    //   \"timeout\": 0,\r\n    //   \"dataType\": \"jsonp\",\r\n    //   \"headers\": {\r\n    //     \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n    //   },\r\n    //   \"data\": {\r\n    //     \"api_key\": api_key,\r\n    //     \"sig\": sig,\r\n    //     \"format\": format,\r\n    //     \"json\": theJSON\r\n    //   }\r\n    // };\r\n\r\n    //console.log(settings);\r\n\r\n    // $.post(\"https://api.sailthru.com/content\", {\r\n    //     \"api_key\": api_key,\r\n    //     \"sig\": sig,\r\n    //     \"format\": format,\r\n    //     \"json\": theJSON\r\n    //   }, function(data) {\r\n    //     console.log('ajax sailthru content api update complete');\r\n    //     console.log(data);\r\n    //   },\r\n    //   \"jsonp\"\r\n    // );\r\n\r\n\r\n    // $.ajax(settings).done(function(response) {\r\n    //   console.log('ajax sailthru content api update complete');\r\n    //   console.log(response);\r\n    // });\r\n\r\n    // var data = `api_key=${api_key}&sig=${sig}&format=${format}&json=${theJSON}`;\r\n\r\n    // console.log(data);\r\n\r\n    // var xhr = new XMLHttpRequest();\r\n    // xhr.withCredentials = true;\r\n    //\r\n    // xhr.addEventListener(\"readystatechange\", function() {\r\n    //   if (this.readyState === 4) {\r\n    //     console.log(this.responseText);\r\n    //   }\r\n    // });\r\n    //\r\n    // xhr.open(\"POST\", \"https://api.sailthru.com/content\");\r\n    // xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n    //\r\n    // xhr.send(data);\r\n\r\n\r\n    var data = new FormData();\r\n    data.append(\"api_key\", api_key);\r\n    data.append(\"format\", format);\r\n    data.append(\"json\", theJSON);\r\n    data.append(\"sig\", sig);\r\n\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.withCredentials = true;\r\n\r\n    xhr.addEventListener(\"readystatechange\", function() {\r\n      if (this.readyState === 4) {\r\n        console.log(this.responseText);\r\n      }\r\n    });\r\n\r\n    xhr.open(\"POST\", \"https://api.sailthru.com/content\");\r\n\r\n    xhr.send(data);\r\n\r\n    if (imgURL !== undefined) {\r\n      $('meta[name=\"sailthru.image.full\"]').attr('content', imgURL);\r\n    }\r\n\r\n    if (sku !== undefined) {\r\n      $('meta[name=\"sku\"]').attr('content', sku);\r\n    }\r\n\r\n    if (price !== undefined) {\r\n      $('meta[name=\"sailthru.price\"]').attr('content', price);\r\n    }\r\n\r\n    Sailthru.track('pageview', {\r\n      \"url\": url,\r\n      onSuccess: function() {\r\n        console.log('trackPageView success');\r\n      },\r\n      onError: function() {\r\n        console.log('trackPageView failure');\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n\r\n});"],"file":"scripts.js"}