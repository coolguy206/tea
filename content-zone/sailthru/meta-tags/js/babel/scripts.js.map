{"version":3,"sources":["../scripts.js"],"names":["$","document","ready","url","window","location","href","color","indexOf","split","toLowerCase","console","log","mpd","text","json","JSON","parse","gender","attr","category","colorTag","colorName","thePrice","priceTag","imgURL","sku","sig","price","inventory","Number","tags","api_key","secret","format","undefined","replace","each","parent_data","i","val","thisColor","large_image_url","theSku","store_price","substring","slice","theJSON","md5","data","FormData","append","xhr","XMLHttpRequest","withCredentials","addEventListener","readyState","responseText","open","send","Sailthru","track","onSuccess","onError"],"mappings":"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","sourcesContent":["$(document).ready(function() {\r\n  var url = window.location.href;\r\n  var color;\r\n  if (url.indexOf('?') !== -1) {\r\n    color = url.split('?')[1];\r\n    color = color.split('#')[1];\r\n    color = color.toLowerCase();\r\n  } else {\r\n    color = url.split('#')[1];\r\n    color = color.toLowerCase();\r\n  }\r\n  // color = $('.pdp-item-details-attributes dt .selected-value').text().toLowerCase();\r\n  console.log(`color: ${color}`);\r\n\r\n\r\n  var mpd = $('#the-mpd').text();\r\n  var json = JSON.parse(mpd);\r\n  var gender = $('#the-mpd').attr('data-department').toLowerCase();\r\n  var category = $('#the-mpd').attr('data-category').toLowerCase();\r\n  var colorTag = $('#the-mpd').attr('data-color').toLowerCase();\r\n  var colorName;\r\n  var thePrice;\r\n  var priceTag;\r\n  var imgURL;\r\n  var sku;\r\n  var sig;\r\n  var price;\r\n  var inventory = Number($('meta[name=\"inventory\"]').attr('content'));\r\n  var tags = `${gender}, ${category}`;\r\n  if (colorTag !== \"\") {\r\n    tags = `${tags}, ${colorTag}`;\r\n  }\r\n  // console.log(`inventory: ${inventory}`);\r\n\r\n  var api_key = `8379ab7deccf4e4aa16a01990e0f4fa2`;\r\n  var secret = `a05b94dd5722b409a097f77b14795d05`;\r\n  var format = `json`;\r\n\r\n\r\n  if (color !== undefined) {\r\n    // if (url.indexOf('#') !== -1) {\r\n\r\n    color = color.replace(/%20/g, \" \");\r\n\r\n    $.each(json.parent_data, function(i, val) {\r\n      var thisColor = val.color;\r\n      thisColor = thisColor.toLowerCase();\r\n\r\n\r\n      if (thisColor.indexOf(color) !== -1) {\r\n        imgURL = val.large_image_url;\r\n\r\n        colorName = thisColor;\r\n\r\n        var theSku = val.sku;\r\n        theSku = theSku.split('-');\r\n        theSku = theSku[0] + '-' + theSku[1];\r\n        sku = theSku;\r\n        // console.log(theSku);\r\n\r\n        thePrice = val.store_price;\r\n        thePrice = Number(thePrice.substring(1));\r\n\r\n        price = val.store_price;\r\n        price = Number(price.slice(1)) * 100;\r\n\r\n        //console.log(price);\r\n      }\r\n    });\r\n\r\n\r\n    console.log(`thePrice: ${thePrice}`);\r\n    if (thePrice <= 25) {\r\n      priceTag = `price-0-25`;\r\n    } else if (thePrice > 25 && thePrice <= 50) {\r\n      priceTag = `price-25-50`;\r\n    } else if (thePrice > 50 && thePrice <= 75) {\r\n      priceTag = `price-50-75`;\r\n    } else if (thePrice > 75 && thePrice <= 100) {\r\n      priceTag = `price-75-100`;\r\n    } else if (thePrice > 100) {\r\n      priceTag = `price-100+`\r\n    }\r\n    console.log(`priceTag: ${priceTag}`);\r\n\r\n    tags = `${tags}, ${colorName}, ${priceTag}`\r\n\r\n    var theJSON = `{\"id\": \"${url}\", \"tags\": \"${tags}\", \"inventory\": ${inventory}, \"price\": ${price}, \"images\":{\"full\": {\"url\": \"${imgURL}\"}, \"thumb\": {\"url\": \"${imgURL}\"}}}`;\r\n    sig = md5(secret + api_key + format + theJSON);\r\n\r\n\r\n    console.log(`\r\n    sig: ${sig}\r\n    \"json\": ${theJSON}\r\n    `);\r\n\r\n\r\n    // var settings = {\r\n    //   \"url\": \"https://api.sailthru.com/content\",\r\n    //   \"method\": \"POST\",\r\n    //   \"timeout\": 0,\r\n    //   \"dataType\": \"jsonp\",\r\n    //   \"headers\": {\r\n    //     \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n    //   },\r\n    //   \"data\": {\r\n    //     \"api_key\": api_key,\r\n    //     \"sig\": sig,\r\n    //     \"format\": format,\r\n    //     \"json\": theJSON\r\n    //   }\r\n    // };\r\n\r\n    //console.log(settings);\r\n\r\n    // $.post(\"https://api.sailthru.com/content\", {\r\n    //     \"api_key\": api_key,\r\n    //     \"sig\": sig,\r\n    //     \"format\": format,\r\n    //     \"json\": theJSON\r\n    //   }, function(data) {\r\n    //     console.log('ajax sailthru content api update complete');\r\n    //     console.log(data);\r\n    //   },\r\n    //   \"jsonp\"\r\n    // );\r\n\r\n\r\n    // $.ajax(settings).done(function(response) {\r\n    //   console.log('ajax sailthru content api update complete');\r\n    //   console.log(response);\r\n    // });\r\n\r\n    // var data = `api_key=${api_key}&sig=${sig}&format=${format}&json=${theJSON}`;\r\n\r\n    // console.log(data);\r\n\r\n    // var xhr = new XMLHttpRequest();\r\n    // xhr.withCredentials = true;\r\n    //\r\n    // xhr.addEventListener(\"readystatechange\", function() {\r\n    //   if (this.readyState === 4) {\r\n    //     console.log(this.responseText);\r\n    //   }\r\n    // });\r\n    //\r\n    // xhr.open(\"POST\", \"https://api.sailthru.com/content\");\r\n    // xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n    //\r\n    // xhr.send(data);\r\n\r\n\r\n    var data = new FormData();\r\n    data.append(\"api_key\", api_key);\r\n    data.append(\"format\", format);\r\n    data.append(\"json\", theJSON);\r\n    data.append(\"sig\", sig);\r\n\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.withCredentials = true;\r\n\r\n    xhr.addEventListener(\"readystatechange\", function() {\r\n      if (this.readyState === 4) {\r\n        console.log(this.responseText);\r\n      }\r\n    });\r\n\r\n    xhr.open(\"POST\", \"https://api.sailthru.com/content\");\r\n\r\n    xhr.send(data);\r\n\r\n    if (imgURL !== undefined) {\r\n      $('meta[name=\"sailthru.image.full\"]').attr('content', imgURL);\r\n    }\r\n\r\n    if (sku !== undefined) {\r\n      $('meta[name=\"sku\"]').attr('content', sku);\r\n    }\r\n\r\n    if (price !== undefined) {\r\n      $('meta[name=\"sailthru.price\"]').attr('content', price);\r\n    }\r\n\r\n    Sailthru.track('pageview', {\r\n      \"url\": url,\r\n      onSuccess: function() {\r\n        console.log('trackPageView success');\r\n      },\r\n      onError: function() {\r\n        console.log('trackPageView failure');\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n\r\n});"],"file":"scripts.js"}