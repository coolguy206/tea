{"version":3,"sources":["../scripts.js"],"names":["$","document","ready","url","window","location","href","ac","emailIsValid","email","test","click","e","target","previousElementSibling","value","valid","hide","show","Sailthru","integration","dataLayer","push","pdpObj","sig","md5","keys","secret","api","baseUrl","data","FormData","append","xhr","XMLHttpRequest","withCredentials","addEventListener","readyState","console","log","responseText","open","send","focus","divinity","box","close","remove"],"mappings":"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","sourcesContent":["import {\r\n  keys\r\n} from './api.js';\r\n// console.log(keys);\r\n\r\n$(document).ready(function() {\r\n  const url = window.location.href;\r\n  const ac = \"Desktop pop-up\";\r\n\r\n  function emailIsValid(email) {\r\n    return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email)\r\n  }\r\n\r\n  $('.signup .form button').click(function(e) {\r\n    // console.log(e.target);\r\n\r\n    var email = e.target.previousElementSibling.value;\r\n    var valid = emailIsValid(email);\r\n    // console.log('valid:' + valid);\r\n\r\n    if (valid) {\r\n      $('.signup .form').hide();\r\n      $('.signup .sending').show();\r\n\r\n      Sailthru.integration(\"userSignUp\", {\r\n        \"id\": email,\r\n        \"email\": email,\r\n        \"lists\": {\r\n          \"MASTER_CONTACTS_LIST\": 1\r\n          // \"test list\": 1\r\n        },\r\n        \"vars\": {\r\n          \"ACQUISITION_SOURCE\": ac,\r\n        },\r\n        \"source\": ac,\r\n        \"onSuccess\": function() {\r\n          $('.signup .the-form').hide();\r\n          $('.signup .thanks').show();\r\n\r\n          window.dataLayer.push({\r\n            'event': 'sailthru',\r\n            'theUrl': url,\r\n            'sailthruEmail': email,\r\n            'sailthruSource': ac\r\n          })\r\n\r\n          var pdpObj = `{\"id\": \"${email}\", \"optout_email\": \"none\"}`;\r\n          // console.log(pdpObj);\r\n\r\n          var sig = md5(`${keys.secret}${keys.api}json${pdpObj}`);\r\n          // console.log(sig);\r\n\r\n          var baseUrl = `https://api.sailthru.com/user`;\r\n\r\n          var data = new FormData();\r\n          data.append(\"api_key\", keys.api);\r\n          data.append(\"format\", \"json\");\r\n          data.append(\"json\", pdpObj);\r\n          data.append(\"sig\", sig);\r\n\r\n          var xhr = new XMLHttpRequest();\r\n          xhr.withCredentials = true;\r\n\r\n          xhr.addEventListener(\"readystatechange\", function() {\r\n            if (this.readyState === 4) {\r\n              console.log(this.responseText);\r\n            }\r\n          });\r\n\r\n          xhr.open(\"POST\", baseUrl);\r\n\r\n          xhr.send(data);\r\n\r\n        }\r\n      });\r\n\r\n    } else {\r\n      $('.signup .error').show();\r\n      $('.signup input').focus();\r\n    }\r\n  });\r\n\r\n\r\n  //close the signup form\r\n  $('.the-overlay, #close-icon2').click(function() {\r\n    // console.log('close desktop');\r\n    divinity.box.close();\r\n    $('#tea-promo-subscribe').remove();\r\n  });\r\n\r\n});"],"file":"scripts.js"}