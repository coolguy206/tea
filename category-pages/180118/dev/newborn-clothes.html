<!--toolkit-->
<style>
	include "../css/newborn-clothes.css"
</style>

<!-- dev css -->
<!-- <link rel="stylesheet" type="text/css" href="../css/newborn-clothes.css"> -->

<!-- <h3 class="mobile title">newborn</h3> -->

<div class="girls-clothing-cat">
	<!-- desktop ref -->
	<!-- <img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/nb-bg-d.jpg" alt="handsome boy" class="ref"/> -->

	<!-- <img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/bg-m.png" alt="" class="ref"/> -->

	<!-- top -->
	<div class="top">
		<div class="desktop">
			<h2>hello baby.<br> hello world.</h2>
			<p>Wrap them in friendly patterns,<br> the softest (and most durable) cotton,<br> and meticulously Mom-tested styles.</p>
		</div>

		<!--mobile -->
		<img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c1-m.png" alt="babies" class="mobile" />
	</div>

	<!-- cell 1 -->
	<div class="c1 cell">

		<div class="first">
			<img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c2a-d.jpg" alt="baby" />
		</div>

		<div class="second">
			<img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c2b-d.jpg" alt="wrap neck styles"  class="desktop"/>

			<h3>gift wrap</h3>
			<p>Comfy, creative, and goes on with a snap<br> instead of a fuss.</p>
			<a href="#" class="cta gift-it">shop wrap neck styles</a>
		</div>

	</div>

	<!-- cell 2 -->
	<div class="c2 cell">
		<div class="first">
			<!-- desktop image -->
			<img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c3a-d.jpg" alt="baby bodysuit outfits"  class="desktop"/>

			<!-- mobile image -->
			<img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c3b-d.jpg" alt="babies"  class="mobile"/>

			<h3>perfect fit</h3>

			<p>Our bodysuits and leggings stretch<br> more so new parents can stress less.</p>
			
			<a href="#" class="cta gift-it">shop bodysuit outfits</a>
		</div>
		<div class="desktop second">
			<img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c3b-d.jpg" alt="babies" />
		</div>
	</div>

	<!-- cell 3 -->
	<div class="c3">

		<div class="first">
			<img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c4a-d.jpg" alt="baby" />
		</div>

		<div class="second">
			<img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c4b-d.jpg" alt="baby unisex styles"  class="desktop"/>

			<h3>surprises welcome</h3>

			<p>No need to know whether that bundle of joy<br> is a boy or a girl.</p>
			<a href="/newborn-clothes/favorites/unisex" class="cta">shop unisex styles</a>
		</div>
	</div>


	<!-- cell 4 -->
	<div class="c4 cell">
		<div class="first">
			<!-- desktop image -->
			<a href="/product/8s62501"><img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c5a-d.jpg" alt="baby rompers"  class="desktop"/></a>
			<!-- mobile image -->
			<img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c5b-d.jpg" alt="baby"  class="mobile"/>

			<h3>footie jams forever</h3>
			<p>There's nothing cuter<br class="desktop"> than a baby with cozy toesies.</p>
			
			<a href="#" class="cta gift-it">shop rompers</a>
		</div>
		<div class="desktop second">
			<img src="https://www.teacollection.com/mas_assets/theme/tea_collection/images/categories/180118/newborn/c5b-d.jpg" alt="baby" />
		</div>
	</div>

</div>

<!-- <script src="/mas_assets/theme/tea_collection/js/jquery.rwdImageMaps.min.js"></script> -->
<!-- bx slider development-->
<!-- <script src="https://www.teacollection.com/mas_assets/theme/tea_collection/js/bxslider/jquery.bxslider.min.js"></script>
<link rel="stylesheet" href="https://www.teacollection.com/mas_assets/theme/tea_collection/js/bxslider/jquery.bxslider.css" /> -->

<!-- bx slider production-->
<script src="/mas_assets/theme/tea_collection/js/bxslider/jquery.bxslider.min.js"></script>
<link rel="stylesheet" href="/mas_assets/theme/tea_collection/js/bxslider/jquery.bxslider.css" />
<script>
$(document).ready(function(e) {
	// $('img[usemap]').rwdImageMaps();

	//dev image src
	// var imgs = $('.top img, .gift-shop-container img');
	// $.each(imgs, function(i,val){
	// 	var src = $(val).attr('src');
	// 	var newSrc = 'https://www.teacollection.com' + src;
	// 	$(val).attr('src', newSrc)
	// });

	var bundle = [];

	var outfit = function(sku1, sku2, sku3){
		var obj = {};
		obj.skus = [sku1,sku2,sku3];
		bundle.push(obj)
	};

	// BUNDLE
	// outfit 1
	// outfit('8s72901-442', '8s62900-405', '8s52900-675');
		
	// dev bundle
	outfit('6f12200-a13', '6f12200-962', '7w12327-061');

	//outfit 2
	outfit('8s72900-061', '8s72902-061', '8s62901-096');
		
	// outfit 3
	outfit('', '', '');
		
	// outfit 4
	outfit('8s62501-F06', '8s52501-F15', '8s72501-F05');
		

	//add bundle to divs
	$.each(bundle, function(i,val){
		var cell = i + 1;
		var skus = val.skus;
		$.each(skus, function(j,arr){
			if(arr !== ""){
				var num = j + 1;
				var data = 'data-sku-' + num;
				$('.c' + cell).attr(data, arr);
			}
		});
	});

	//sold out function
	var soldOut = function(elem, i){
		//if sold out
		if($(elem).length < 2){
			// console.log('sold out');
			//add the sold out badge
			$('.li-' + i + '> div').prepend('<img src="https://s.tea-global.net/mas_assets/theme/tea_collection/images/misc/SoldOutBadge_lrg.gif" alt="sold out" class="sold-out">');
			//hide the dropdown and add to bag
			$('.li-' + i).find('.sizes-container').hide();
			$('.li-' + i).find('select').hide();
			$('.li-' + i).find('.cta').hide();
		}
	};
	
	// console.log(bundle);	

			//gift-it click
		$('.gift-it').click(function(e){
			e.preventDefault();

			//remove any .drop on the page
			$('.drop').remove();

			//variables
			var div = $(this).closest('.cell');
			var sku1 = $(div).attr('data-sku-1');
			var sku2 = $(div).attr('data-sku-2');
			var sku3 = $(div).attr('data-sku-3');
			var skus = [sku1, sku2, sku3];

			// close svg element
			var closeSvg = '<span class="close"><svg width="15" height="15" viewBox="0 0 15 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>X to close</title><desc>Created using Figma</desc><g id="Canvas" transform="translate(4130 14276)"><g id="X to close"><g id="Rectangle"><use xlink:href="#path0_fill" transform="matrix(-0.707974 -0.706238 0.706284 -0.707928 -4129.23 -14261)" fill="#666666"/></g><g id="Rectangle"><use xlink:href="#path1_fill" transform="matrix(-0.706284 0.707928 -0.707974 -0.706238 -4115 -14261.8)" fill="#666666"/></g></g></g><defs><path id="path0_fill" d="M 0 0L 1.05949 0L 1.05949 20.1303L 0 20.1303L 0 0Z"/><path id="path1_fill" d="M 0 0L 1.05949 0L 1.05949 20.1303L 0 20.1303L 0 0Z"/></defs></svg></span>'; 

			//add the .drop element
			$(div).after('<div class="drop"><ul><li class="close-svg">'+closeSvg+'</li><li class="loading" style="width:100% !important"><h3>LOADING...</h3></li></ul></div>');

			//hide the close icon
			$('.close-svg').hide();

			//.close click
			$('.close').click(function(){
				$('.drop').remove();
			});

			//console.log(skus);

			//get the items
			$.each(skus, function(i,val){
				if(val !== undefined){
					var sku = val.split('-')[0];
					var skuColor = val.split('-')[1];
					
					$.get('https://www.teacollection.com/product/' + sku, function(data){
						// console.log($(data).find('#the-mpd'));

						var theData = $(data).find('#the-mpd').text();
						var jsonData = JSON.parse(theData);
						// console.log(jsonData);

						var id = Object.keys(jsonData.parent_data)[0];
						// console.log(id);

						var title = jsonData.parent_data[id].model;
						var price = jsonData.parent_data[id].store_price;
						var imgSrc;
						// var imgSrc = jsonData.parent_data[id].small_image_url;
						// console.log(title, price, imgSrc);
						
						//get the sizes
						var sizesArray = [];
						//loop through jsonData
						$.each(jsonData.parent_data, function(j,obj){
							
							var objSku = obj.sku.split('-')[1];
							// console.log(skuColor, objSku);

							//if matches color num
							if(skuColor == objSku){
								// console.log('match', skuColor, objSku);

								//get the image src
								imgSrc = obj.small_image_url;
								// console.log(j,obj,imgSrc);

								//if store_quantity > 0
								if(obj.store_quantity > 0){
									//push to sizesArray
									sizesArray.push(obj.size);
								}
							}
						});

						//sort the sizesArray
						sizesArray.sort(function(a, b){return a-b});
						// console.log(sizesArray);

						var dropdownIcon = '<svg width="10" height="6" viewBox="0 0 10 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Vector</title><desc>Created using Figma</desc><g id="Canvas" transform="translate(371 14198)"><g id="Vector"><use xlink:href="#path0_fill" transform="translate(-371 -14198)" fill="#999999"/></g></g><defs><path id="path0_fill" d="M 8.98305 0L 5.08475 3.83333L 1.01695 0L 0 1L 5.08475 6L 10 1L 8.98305 0Z"/></defs></svg>';

						//desktop
						if($(window).width() > 737){
							var li = '<li class="li-'+i+'"><div><img src="'+imgSrc+'" alt="'+title+'"/><h3><span class="title">'+title+'</span><br><span class="price">'+price+'</span></h3><div class="sizes-container sizes-wrap-'+i+'"><ul class="sizes-'+i+'"><li>size</li></ul></div><a href="#" class="cta add-to-bag-'+i+' disabled">add to bag</a><h4 class="size-error error-'+i+'">Please select a size</h4></div></li>';
						}
						//mobile
						else if($(window).width() < 737){
							var li = '<li class="li-'+i+'"><div><img src="'+imgSrc+'" alt="'+title+'"/><h3><span class="title">'+title+'</span><br><span class="price">'+price+'</span></h3><select class="sizes-'+i+'"><option>size</option></select><a href="#" class="cta add-to-bag-'+i+' disabled">add to bag</a><h4 class="size-error error-'+i+'">Please select a size</h4></div></li>';
						}  

						

						//make the drop down element
						$('.drop > ul').append(li);


						//show the close svg icon
						$('.close-svg').show();

						//desktop output sizes dropdown
						if($(window).width()> 737){
							//add the sizes to the dropdown
							$.each(sizesArray, function(k, size){
								$('.sizes-' + i).append('<li value="'+size+'">'+size+'</li>');
							});

							//if sold out
							soldOut('.sizes-' + i + ' li', i);


							//hide show the sizes dropdown
							$('.sizes-' + i).click(function(){
								$(this).closest('.sizes-container').toggleClass('show-sizes');
							});

							//sizes dropdown li click
							$('.sizes-' + i + ' li').click(function(){
								$('.sizes-' + i + ' li').removeAttr('class');
								var text = $(this).text();
								if(text !== 'size') {
									$(this).addClass('selected');
									var num = $(this).text();
									$('.sizes-' + i + ' li:first-of-type').text(num);
									$('.add-to-bag-' + i).removeClass('disabled');
									$('.error-' + i).hide();
								}
							
							});
						}

						// mobile output sizes dropdown
						else if($(window).width()< 737) {
							//add the sizes to the dropdown
							$.each(sizesArray, function(k, size){
								$('.sizes-' + i).append('<option value="'+size+'">'+size+'</option>');
							});

							//if sold out
							soldOut('.sizes-' + i + ' option', i);
						}
						

						//remove the loading
						$('.loading').remove();

						//desktop only adjust width of .drop ul
						if($(window).width()>737){
							//adjust the width of .drop > ul
							var theLength = $('.drop > ul > li');
						
							var count = 0;
							$.each(theLength, function(j,arr){
								if(j !== 0) {
									var width = $(arr).outerWidth();
									count = count + width;
								}
							});

							$('.drop > ul').css('width', count + 'px');
						}
						
						
						//select change
						$('.sizes-' + i).change(function(){
							var theVal = $(this).val();
							// if select is a number remove .disable from the add to bag
							if(theVal !== 'size') {
								$('.add-to-bag-' + i).removeClass('disabled');
								$('.error-' + i).hide();
							} else {
								$('.add-to-bag-' + i).addClass('disabled');
							}
						});

						//add to bag click
						$('.add-to-bag-' + i).click(function(e){
							e.preventDefault();
							var li = $(this).closest('li');
							var title = $(li).find('.title').text();

							//desktop
							if($(window).width()>737){
								var select = $(this).siblings('.sizes-container').find('.selected').html();
							}

							//mobile
							else if($(window).width()<737){
								var select = $(this).siblings('select').val();
							}

							//if size not selected
							if(select == undefined || select == 'size'){
								$('.error-' + i).show();
								$('.sizes-' + i).focus();
							} else {
								$('.error-' + i).hide();
								//build the url
								var buyUrl = '/?page=item&action=buy&id[0]=' + val + '-' + select + '&qty[0]=1';

								//hide the cta
								$('.add-to-bag-' + i).hide();
								//add the processing message
								$('.add-to-bag-' + i).after('<h4 class="processing">PROCESSING...</h4>');
								//add to bag function
								$.post(buyUrl, function(){
									$('.processing').html('SUCCESS!!!');

									$(li).append('<div class="success"><h3>'+title+' added to cart.</h3><i>'+closeSvg+'</i></div>');
									
									$('#view-cart').trigger('mouseenter');
									
									// close the popup on click
									$('.success i').click(function(){
										$('.success').remove();
										$('.processing').remove();
										$('.add-to-bag-' + i).fadeIn();
									});

									setTimeout(function(){
										$('.processing').remove();
										$('.success').fadeOut();
										$('.add-to-bag-' + i).fadeIn();
									},2000);
								});

							}
						});
					});
				} 

			});

		});
});
</script>