{"version":3,"sources":["../scripts.js"],"names":["$","document","ready","a","b","window","location","href","c","find","d","test","e","indexOf","f","split","each","console","log","g","concat","hide","append","show","h","click","preventDefault","val","Sailthru","integration","id","email","lists","MASTER_CONTACTS_LIST","vars","ACQUISITION_SOURCE","source","onSuccess","dataLayer","push","event","theUrl","sailthruEmail","sailthruSource","pdpObj","sig","md5","keys","secret","api","baseUrl","data","FormData","xhr","XMLHttpRequest","withCredentials","addEventListener","readyState","responseText","open","send","onError"],"mappings":";;AAAA;;AAIAA,CAAC,CAACC,QAAD,CAAD,CAAYC,KAAZ,CAAkB,YAAW;AAC3B,MAAIC,CAAJ;AAAA,MACEC,CAAC,GAAGC,MAAM,CAACC,QAAP,CAAgBC,IADtB;AAAA,MAEEC,CAAC,GAAGR,CAAC,CAAC,aAAD,CAAD,CAAiBS,IAAjB,CAAsB,QAAtB,CAFN;AAAA,MAGEC,CAAC,GAAG,SAAJA,CAAI,CAASP,CAAT,EAAY;AACd,WAAO,yBAAyBQ,IAAzB,CAA8BR,CAA9B,CAAP;AACD,GALH;AAAA,MAMES,CAAC,GAAG,IANN;;AAOA,MAAIR,CAAC,CAACS,OAAF,CAAU,GAAV,MAAmB,CAAC,CAAxB,EAA2B;AACzB,QAAIC,CAAC,GAAGV,CAAC,CAACW,KAAF,CAAQ,GAAR,EAAa,CAAb,EAAgBA,KAAhB,CAAsB,GAAtB,CAAR;;AACA,QACGf,CAAC,CAACgB,IAAF,CAAOF,CAAP,EAAU,UAASV,CAAT,EAAYI,CAAZ,EAAe;AACtB,UAAIA,CAAC,CAACK,OAAF,CAAU,cAAV,MAA8B,CAAC,CAAnC,EAAsC;AACpC,YAAIH,CAAC,GAAGF,CAAC,CAACO,KAAF,CAAQ,GAAR,EAAa,CAAb,CAAR;AACAZ,QAAAA,CAAC,GAAGO,CAAJ;AACD,OAHD,MAGO,IAAIF,CAAC,CAACK,OAAF,CAAU,GAAV,MAAmB,CAAC,CAAxB,EAA2B;AAChC,YAAIC,CAAC,GAAGN,CAAC,CAACO,KAAF,CAAQ,GAAR,EAAa,CAAb,CAAR;AACAH,QAAAA,CAAC,GAAGE,CAAJ;AACD;AACF,KARF,GASCG,OAAO,CAACC,GAAR,CAAYN,CAAZ,CATD,EAUC,SAASA,CAXb,EAYE;AACA,UAAIO,CAAC,GAAG,wDAAwDC,MAAxD,CAA+DR,CAA/D,EAAkE,8BAAlE,CAAR;AACAZ,MAAAA,CAAC,CAAC,+BAAD,CAAD,CAAmCqB,IAAnC,IAA2CrB,CAAC,CAAC,qCAAD,CAAD,CAAyCsB,MAAzC,CAAgDH,CAAhD,CAA3C,EAA+FnB,CAAC,CAAC,4BAAD,CAAD,CAAgCuB,IAAhC,EAA/F;AACA,UAAIC,CAAC,GAAG,qDAAqDJ,MAArD,CAA4DR,CAA5D,EAA+D,YAA/D,CAAR;AACAZ,MAAAA,CAAC,CAAC,8BAAD,CAAD,CAAkCqB,IAAlC,IAA0CrB,CAAC,CAAC,oCAAD,CAAD,CAAwCsB,MAAxC,CAA+CE,CAA/C,CAA1C;AACD;AACF,GApBD,MAoBOrB,CAAC,GAAG,4BAAJ;;AACPH,EAAAA,CAAC,CAACQ,CAAD,CAAD,CAAKiB,KAAL,CAAW,UAASjB,CAAT,EAAY;AACrBA,IAAAA,CAAC,CAACkB,cAAF;AACA,QAAId,CAAC,GAAGZ,CAAC,CAAC,aAAD,CAAD,CAAiBS,IAAjB,CAAsB,OAAtB,EAA+BkB,GAA/B,EAAR;AACA3B,IAAAA,CAAC,CAAC,oBAAD,CAAD,CAAwBqB,IAAxB;AACA,QAAIP,CAAC,GAAGJ,CAAC,CAACE,CAAD,CAAT;AACAE,IAAAA,CAAC,IAEEd,CAAC,CAAC,sCAAD,CAAD,CAA0CuB,IAA1C,IACCvB,CAAC,CAAC,2BAAD,CAAD,CAA+BqB,IAA/B,EADD,EAECO,QAAQ,CAACC,WAAT,CAAqB,YAArB,EAAmC;AACjCC,MAAAA,EAAE,EAAElB,CAD6B;AAEjCmB,MAAAA,KAAK,EAAEnB,CAF0B;AAGjCoB,MAAAA,KAAK,EAAE;AACLC,QAAAA,oBAAoB,EAAE;AADjB,OAH0B;AAMjCC,MAAAA,IAAI,EAAE;AACJC,QAAAA,kBAAkB,EAAEhC;AADhB,OAN2B;AASjCiC,MAAAA,MAAM,EAAEjC,CATyB;AAUjCkC,MAAAA,SAAS,EAAE,qBAAW;AACpBpB,QAAAA,OAAO,CAACC,GAAR,CAAY,qCAAZ,GAAoDlB,CAAC,CAAC,sBAAD,CAAD,CAA0BqB,IAA1B,EAApD,EAAsFrB,CAAC,CAAC,qBAAD,CAAD,CAAyBuB,IAAzB,EAAtF,EAAuHlB,MAAM,CAACiC,SAAP,CAAiBC,IAAjB,CAAsB;AAC3IC,UAAAA,KAAK,EAAE,UADoI;AAE3IC,UAAAA,MAAM,EAAErC,CAFmI;AAG3IsC,UAAAA,aAAa,EAAE9B,CAH4H;AAI3I+B,UAAAA,cAAc,EAAExC;AAJ2H,SAAtB,CAAvH;AAOA,YAAIyC,MAAM,wBAAchC,CAAd,oCAAV,CARoB,CASpB;;AAEA,YAAIiC,GAAG,GAAGC,GAAG,WAAIC,UAAKC,MAAT,SAAkBD,UAAKE,GAAvB,iBAAiCL,MAAjC,EAAb,CAXoB,CAYpB;;AAEA,YAAIM,OAAO,kCAAX;AAEA,YAAIC,IAAI,GAAG,IAAIC,QAAJ,EAAX;AACAD,QAAAA,IAAI,CAAC7B,MAAL,CAAY,SAAZ,EAAuByB,UAAKE,GAA5B;AACAE,QAAAA,IAAI,CAAC7B,MAAL,CAAY,QAAZ,EAAsB,MAAtB;AACA6B,QAAAA,IAAI,CAAC7B,MAAL,CAAY,MAAZ,EAAoBsB,MAApB;AACAO,QAAAA,IAAI,CAAC7B,MAAL,CAAY,KAAZ,EAAmBuB,GAAnB;AAEA,YAAIQ,GAAG,GAAG,IAAIC,cAAJ,EAAV;AACAD,QAAAA,GAAG,CAACE,eAAJ,GAAsB,IAAtB;AAEAF,QAAAA,GAAG,CAACG,gBAAJ,CAAqB,kBAArB,EAAyC,YAAW;AAClD,cAAI,KAAKC,UAAL,KAAoB,CAAxB,EAA2B;AACzBxC,YAAAA,OAAO,CAACC,GAAR,CAAY,KAAKwC,YAAjB;AACD;AACF,SAJD;AAMAL,QAAAA,GAAG,CAACM,IAAJ,CAAS,MAAT,EAAiBT,OAAjB;AAEAG,QAAAA,GAAG,CAACO,IAAJ,CAAST,IAAT;AACD,OA5CgC;AA6CjCU,MAAAA,OAAO,EAAE,mBAAW;AAClB5C,QAAAA,OAAO,CAACC,GAAR,CAAY,mCAAZ;AACD;AA/CgC,KAAnC,CAJH,KAqDElB,CAAC,CAAC,oBAAD,CAAD,CAAwBuB,IAAxB,IAAgCvB,CAAC,CAAC,2BAAD,CAAD,CAA+BuB,IAA/B,EAAhC,EAAuEvB,CAAC,CAAC,sCAAD,CAAD,CAA0CqB,IAA1C,EArDzE,CAAD;AAsDD,GA3DD;AA4DD,CAzFD","sourcesContent":["import {\r\n  keys\r\n} from './api.js';\r\n\r\n$(document).ready(function() {\r\n  var a,\r\n    b = window.location.href,\r\n    c = $(\".email-wrap\").find(\"button\"),\r\n    d = function(a) {\r\n      return /^[^s@]+@[^s@]+.[^s@]+$/.test(a);\r\n    },\r\n    e = null;\r\n  if (b.indexOf(\"?\") !== -1) {\r\n    var f = b.split(\"?\")[1].split(\"&\");\r\n    if (\r\n      ($.each(f, function(b, c) {\r\n          if (c.indexOf(\"utm_campaign\") !== -1) {\r\n            var d = c.split(\"=\")[1];\r\n            a = d;\r\n          } else if (c.indexOf(\"p\") !== -1) {\r\n            var f = c.split(\"=\")[1];\r\n            e = f;\r\n          }\r\n        }),\r\n        console.log(e),\r\n        null !== e)\r\n    ) {\r\n      var g = \"<p>Sign up for exclusive offers, new<br> styles, and \".concat(e, \"% off your first order!*</p>\");\r\n      $(\".email-wrap .sign-up .default\").hide(), $(\".email-wrap .sign-up .promo-message\").append(g), $(\".email-wrap .new-customers\").show();\r\n      var h = '<p>Keep an eye on your<br class=\"br-m\"> inbox for '.concat(e, \"% off.</p>\");\r\n      $(\".email-wrap .thanks .default\").hide(), $(\".email-wrap .thanks .promo-message\").append(h);\r\n    }\r\n  } else a = \"email sign up landing page\";\r\n  $(c).click(function(c) {\r\n    c.preventDefault();\r\n    var e = $(\".email-wrap\").find(\"input\").val();\r\n    $(\".email-wrap .error\").hide();\r\n    var f = d(e);\r\n    f\r\n      ?\r\n      ($(\".email-wrap .sign-up .load-more-wrap\").show(),\r\n        $(\".email-wrap .input-fields\").hide(),\r\n        Sailthru.integration(\"userSignUp\", {\r\n          id: e,\r\n          email: e,\r\n          lists: {\r\n            MASTER_CONTACTS_LIST: 1\r\n          },\r\n          vars: {\r\n            ACQUISITION_SOURCE: a\r\n          },\r\n          source: a,\r\n          onSuccess: function() {\r\n            console.log(\"sailthru email sign up page success\"), $(\".email-wrap .sign-up\").hide(), $(\".email-wrap .thanks\").show(), window.dataLayer.push({\r\n              event: \"sailthru\",\r\n              theUrl: b,\r\n              sailthruEmail: e,\r\n              sailthruSource: a\r\n            });\r\n\r\n            var pdpObj = `{\"id\": \"${e}\", \"optout_email\": \"none\"}`;\r\n            // console.log(pdpObj);\r\n\r\n            var sig = md5(`${keys.secret}${keys.api}json${pdpObj}`);\r\n            // console.log(sig);\r\n\r\n            var baseUrl = `https://api.sailthru.com/user`;\r\n\r\n            var data = new FormData();\r\n            data.append(\"api_key\", keys.api);\r\n            data.append(\"format\", \"json\");\r\n            data.append(\"json\", pdpObj);\r\n            data.append(\"sig\", sig);\r\n\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.withCredentials = true;\r\n\r\n            xhr.addEventListener(\"readystatechange\", function() {\r\n              if (this.readyState === 4) {\r\n                console.log(this.responseText);\r\n              }\r\n            });\r\n\r\n            xhr.open(\"POST\", baseUrl);\r\n\r\n            xhr.send(data);\r\n          },\r\n          onError: function() {\r\n            console.log(\"sailthru email sign up page error\");\r\n          },\r\n        })) :\r\n      ($(\".email-wrap .error\").show(), $(\".email-wrap .input-fields\").show(), $(\".email-wrap .sign-up .load-more-wrap\").hide());\r\n  });\r\n});"],"file":"scripts.js"}